<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Material Design Bootstrap</title>
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
    />
    <!-- Bootstrap core CSS -->
    <link href="./static/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Material Design Bootstrap -->
    <link href="./static/css/mdb.min.css" rel="stylesheet" />
    <!-- Your custom styles (optional) -->
    <link href="./static/css/style.css" rel="stylesheet" />
    <!--Import Google Icon Font-->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <!--Import materialize.css-->
    <!--
	<link type="text/css" rel="stylesheet" href="./static/css/materialize.min.css"  media="screen,projection"/>
-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- AXIOS-->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <!-- Vue -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  </head>

  <body>
    <!--Modal: Insert new spesa-->
    <div
      class="modal fade"
      id="modalInsertNewSpesa"
      tabindex="-1"
      role="dialog"
      aria-labelledby="myModalLabel"
      aria-hidden="true"
    >
      <div
        class="modal-dialog cascading-modal modal-avatar modal-sm"
        role="document"
      >
        <!--Content-->
        <div class="modal-content">
          <!--Header-->

          <div class="modal-header">
            <img
              src="https://mdbootstrap.com/img/Photos/Avatars/img%20%281%29.jpg"
              alt="avatar"
              class="rounded-circle img-responsive"
            />
          </div>

          <!--Body-->
          <div class="modal-body text-center mb-1">
            <h5 class="mt-1 mb-2"><b>NUOVA SPESA</b></h5>
            <div class="md-form ml-0 mr-0">
              <select
                class="browser-default custom-select"
                id="selectCategoria"
              >
                <option selected disabled>Categoria spesa</option>
                <!--<option value="Bar">Bar</option>
						<option value="Benzina">Benzina</option>
						<option value="Abarth">Abarth</option>-->
              </select>
            </div>
            <div class="md-form ml-0 mr-0">
              <input
                type="number"
                id="importoSpesa"
                class="form-control form-control-sm validate ml-0"
              />
              <label
                data-error="wrong"
                data-success="right"
                for="importoSpesa"
                class="ml-0"
                >Importo spesa</label
              >
            </div>
            <div class="md-form ml-0 mr-0">
              <input
                type="text"
                id="descrizioneSpesa"
                class="form-control form-control-sm validate ml-0"
              />
              <label
                data-error="wrong"
                data-success="right"
                for="descrizioneSpesa"
                class="ml-0"
                >Descrizione spesa (opzionale)</label
              >
            </div>

            <div class="md-form ml-0 mr-0">
              <input type="text" class="datepicker" id="datepicker" />
            </div>
            <div class="text-center mt-4">
              <button
                class="open-add btn btn-cyan mt-1"
                onClick="insertSpesa()"
              >
                Salva <i class="fas fa-sign-in ml-1"></i>
              </button>
            </div>
          </div>
        </div>
        <!--/.Content-->
      </div>
    </div>
    <!--Modal: Login with Avatar Form-->

    <!--Modal: Insert new categoria-->
    <div
      class="modal fade"
      id="modalInsertNewCategoria"
      tabindex="-1"
      role="dialog"
      aria-labelledby="myModalLabel"
      aria-hidden="true"
    >
      <div
        class="modal-dialog cascading-modal modal-avatar modal-sm"
        role="document"
      >
        <!--Content-->
        <div class="modal-content">
          <!--Header-->

          <div class="modal-header">
            <img
              src="https://mdbootstrap.com/img/Photos/Avatars/img%20%281%29.jpg"
              alt="avatar"
              class="rounded-circle img-responsive"
            />
          </div>

          <!--Body-->
          <div class="modal-body text-center mb-1">
            <h5 class="mt-1 mb-2"><b>NUOVA CATEGORIA</b></h5>
            <div class="md-form ml-0 mr-0">
              <select
                class="browser-default custom-select"
                id="selectColoreCategoria"
              >
                <option selected disabled>Colore categoria</option>
                <option value="table-primary">Blu</option>
                <option value="table-success">Verde</option>
                <option value="table-danger">Rosso</option>
                <option value="table-info">Azzurro</option>
                <option value="table-warning">Arancio</option>
                <option value="table-secondary">Grigio</option>
              </select>
            </div>
            <div class="md-form ml-0 mr-0">
              <input
                type="text"
                id="nomeCategoria"
                class="form-control form-control-sm validate ml-0"
              />
              <label
                data-error="wrong"
                data-success="right"
                for="nome"
                class="ml-0"
                >Nome</label
              >
            </div>

            <div class="text-center mt-4">
              <button
                class="open-add btn btn-cyan mt-1"
                onClick="insertCategoria()"
              >
                Crea<i class="fas fa-sign-in ml-1"></i>
              </button>
            </div>
          </div>
        </div>
        <!--/.Content-->
      </div>
    </div>
    <!--Modal: insert new categoria-->

    <!-- Start your project here-->
    <div class="container p-5" id="app-table">
      <div class="row p-5">
        <div class="col-4">
          <a
            class="btn-floating btn-lg btn-primary waves-effect waves-light"
            data-toggle="modal"
            data-target="#modalInsertNewSpesa"
            ><i class="fas fa-plus"></i
          ></a>
        </div>
        <div class="col-4">
          <a
            class="btn-floating btn-lg btn-secondary waves-effect waves-light"
            data-toggle="modal"
            data-target="#modalInsertNewCategoria"
            ><i class="fas fa-plus"></i
          ></a>
        </div>
        <div class="col-4">.col-4</div>
      </div>
      <div class="row">
        <div class="col-12">
          <p id="errorMessage"></p>

          <table class="table table-striped">
            <thead>
              <tr>
                <th scope="col">INDEX</th>

                <th scope="col">EXPENSE_ID</th>
                <th scope="col">CATEGORY_ID</th>
                <th scope="col">NAME</th>
                <th scope="col">DESCRIPTION</th>
                <th scope="col">PRICE</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="expense, index in expenses">
                <th scope="row">[[index+1]]</th>
                <td>[[expense.expense_id]]</td>
                <td>[[ expense.category_id ]]</td>
                <td>[[ expense.name ]]</td>
                <td>[[ expense.description ]]</td>
                <td>[[ expense.price ]]</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script>
      //import axios from "axios";

      var app = new Vue({
        el: "#app-table",
        delimiters: ["[[", "]]"],
        data: {
          expenses: [],
        },
        methods: {
          getExpenses: function () {
            var self = this;
            axios
              .get("/expenses")
              .then(function (response) {
                self.expenses = response.data;
                console.log(response);
              })
              .catch(function (error) {
                // handle error
                console.log(error);
              })
              .then(function () {
                // always executed
              });
          },
        },
        mounted: function () {
          this.getExpenses();
        },
      });
    </script>

    <!-- JQuery -->
    <script
      type="text/javascript"
      src="./static/js/jquery-3.4.1.min.js"
    ></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="./static/js/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="./static/js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="./static/js/mdb.min.js"></script>

    <!-- materialize 
    <script
      type="text/javascript"
      src="./static/js/materialize.min.js"
    ></script>
    -->
  </body>
</html>
